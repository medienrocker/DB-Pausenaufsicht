   </div>

<table id="pausenaufsicht-table">
        <thead>
            <tr>
                <th>Pause</th>
                <th>Orte</th>
                <th>Mo</th>
                <th>Di</th>
                <th>Mi</th>
                <th>Do</th>
                <th>Fr</th>
            </tr>
        </thead>
        <tbody>
            <!-- Table body will be dynamically generated by JavaScript -->
        </tbody>
    </table>

 <script>
// Wait for the DOM to be fully loaded
document.addEventListener('DOMContentLoaded', function() {
    // Extract data from slot spans
    const slotData = {};
    const slots = document.querySelectorAll('#moodle-fields-container span[class^="slot"]');
    
    slots.forEach(slot => {
        const slotNumber = slot.className;
        const value = slot.textContent.trim();
        if (value !== '') {
            if (!slotData[slotNumber]) {
                slotData[slotNumber] = [];
            }
            slotData[slotNumber].push(value);
        }
    });

    // Sort the slotData object by keys (slot numbers)
    const sortedSlotData = Object.fromEntries(
        Object.entries(slotData).sort(([a], [b]) => a.localeCompare(b))
    );

    // Log the sorted data for debugging
    console.log(sortedSlotData);

    // Generate the table
    generatePausenaufsichtTable(sortedSlotData);
});

function generatePausenaufsichtTable(slotData) {
    const tableBody = document.querySelector('#pausenaufsicht-table tbody');
    const weekdays = ['Mo', 'Di', 'Mi', 'Do', 'Fr'];
    const pauses = Array.from({ length: NUM_PAUSES }, (_, i) => `${i + 1}. Pause`);

    tableBody.innerHTML = ''; // Clear existing content

    let slotIndex = 1;
    pauses.forEach((pause, pauseIndex) => {
        ORTE.forEach((ort, ortIndex) => {
            const row = document.createElement('tr');

            // Pause cell (only for the first row of each pause)
            if (ortIndex === 0) {
                const pauseCell = document.createElement('td');
                pauseCell.textContent = pause;
                pauseCell.className = 'pause-cell';
                pauseCell.rowSpan = ORTE.length;
                row.appendChild(pauseCell);
            }

            // Orte cell
            const orteCell = document.createElement('td');
            orteCell.textContent = ort;
            orteCell.className = 'orte-cell';
            row.appendChild(orteCell);

            // Weekday cells
            weekdays.forEach((day, dayIndex) => {
                const dayCell = document.createElement('td');
                dayCell.className = 'content-cell';
                const container = document.createElement('div');
                container.className = 'subcell-container';

                const slotKey = `slot${String(slotIndex).padStart(3, '0')}`;
                const entries = slotData[slotKey] || [];
                const numSubcells = Math.max(entries.length, NUM_TEACHERS_NEEDED);

                for (let j = 0; j < numSubcells; j++) {
                    const subcell = document.createElement('div');
                    subcell.className = 'subcell-item';

                    if (j < entries.length) {
                        const span = document.createElement('span');
                        span.textContent = entries[j];
                        subcell.appendChild(span);
                        
                        if (j < NUM_TEACHERS_NEEDED) {
                            subcell.classList.add('filled');
                        } else {
                            subcell.classList.add('overfilled');
                        }
                    }

                    container.appendChild(subcell);
                }

                dayCell.appendChild(container);
                row.appendChild(dayCell);
                slotIndex++;
            });

            tableBody.appendChild(row);
        });
    });

    // Hide the original container of Moodle fields
    document.getElementById('moodle-fields-container').style.display = 'none';
}
    </script>